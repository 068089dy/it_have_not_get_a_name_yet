# 啥是文件系统

文件系统是一种用于向用户提供底层数据访问的机制。它将设备中的空间划分为特定大小的块（或者称为簇），一般每块512字节。数据存储在这些块中，大小被修正为占用整数个块。由文件系统软件来负责将这些块组织为文件和目录，并记录哪些块被分配给了哪个文件，以及哪些块没有被使用。

简单的理解，文件系统就是负责组织管理使用存储设备的（也可能是其他设备）。

文件系统中一般包含文件名、元数据、安全访问等几个要素。文件名就是好理解啦，是否限制文件名长度，是否可以使用特殊字符（如emoji），是否大小写敏感；元数据则是保存文件自身信息的一块数据，比如说文件的创建、修改、访问时间戳，文件所有者，访问权限等。

![](/assets/filesystem/windows_bad_filename.jpg)

Windows限制使用一些特殊的字符作为文件名

文件系统要是分类的话，按照存储设备的不同，可以分为磁盘文件系统、光盘文件系统等。

# 常见的文件系统
说了这么多概念性的东西，那么常见的有哪些文件系统呢？以最常见的磁盘文件系统为例，有：
* FAT12/FAT16
* FAT32/VFAT
* FAT64/exFAT
* NTFS
以上这四个都是在 Windows 家族中经常使用的文件系统，在 Linux 中经常使用的有：
* Btrfs
* JFS
* ext系列：ext2、ext3、ext4
* XFS
除此之外，macOS（Mac OS X）先后使用过：
* HFS
* HFS+
* APFS

![](/assets/filesystem/fat32_4gb.jpg)

对于FAT32等老旧的文件系统来说，是不支持大于4GiB的单个文件的。

# ext4
**Question：是否需要介绍ext4的文件系统格式，比如说inode等？**

# Linux下 的文件系统管理方式
## 与 Windows 的不同之处
在 Windows 下，我们习惯将硬盘分为 C、D、E、F 等多个分区来进行管理，然而在 Linux 下却没有这种说法。在 Linux 下，一切起始于根（/），通常我们会将硬盘划分为多个不同的“部分”，用于挂载不同类型的文件系统。
## 存储设备的指示
通常，我们现在使用SATA、M2接口的硬盘，此时 Linux 会管这类设备叫做sda, sdb, sdc等；对于U盘，Linux 也会叫做sda, sdb。那些老式的IDE硬盘一般会叫做hdd，更老的软盘就叫做fdd啦。

本着“一切皆文件”的哲学思想，Linux 把硬件设备也当作文件“映射”到根的`/dev`下，所以，如果要表示你系统中第一块硬盘，我们就可以叫它`/dev/sda`啦，这就有点 Windows 的磁盘管理中的“磁盘0”一样的感觉。如果你有第二块硬盘，那么就会叫做`/dev/sdb`，如果你再插上的U盘，那么U盘就叫`/dev/sdc`啦。
## 分区概述
咱了解 Windows 可以把整个硬盘分成C、D、E、F等等，但是 Linux 中分区的概念不像 Windows 中那样分明。

通常，我们管 Windows 的第一个分区叫做C，第二个叫D，依次类推。实际上很可能不是这样，在C的前面可能会有EFI、MSR分区以及任何可能的分区，并且只要是隐藏的分区，资源管理器就看不到啦。

在Linux下，怎么表示分区呢？好的，第一块硬盘的第一个分区就叫`/dev/sda1`，第二个分区就叫`/dev/sda2`，第二块硬盘的第三个分区就叫`/dev/sdb3`，无论这个分区是什么文件系统的，都是这样表达的。

## 分区表、主分区、扩展分区、逻辑分区
在说这些概念之前，我们要知道，磁盘需要一种“分区表”来组织管理结构。我们常用的有GUID分区表（GPT），Apple Partition Map（APM）以及MBR。
MBR分区表是一种非常古老的结构……

MBR 限制了磁盘只可能有4个主分区，所以标号为1、2、3、4预留给了主分区，逻辑分区只能从5开始。

所以，可能在MBR分区表上，你可能会看到sda1，然后是sda5，sda6，这就意味着sda5、sda6是逻辑分区而sda1是主分区。
